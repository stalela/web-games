
    this.gameCards.push(card);
  }

  /**
   * Create difficulty stars for game cards (Juicy Style)
   */
  createDifficultyStars(difficulty, cardSize) {
    const stars = [];

    for (let i = 1; i <= difficulty; i++) {
      const star = this.add.sprite(0, 0, `difficulty${Math.min(i, 3)}`);
      star.setScale(0.8); // Larger for more visibility
      star.setTint(0xFACA2A); // Lalela Yellow instead of generic gold
      stars.push(star);
    }

    return stars;
  }

  /**
   * Filter games by category
   */
  filterGamesByCategory(categoryId) {
    let visibleGames;

    if (categoryId === 'all') {
      visibleGames = this.allGames;
    } else {
      visibleGames = this.allGames.filter(game => game.category === categoryId);
    }

    // Calculate grid layout
    const gridWidth = this.gridConfig.areaRight - this.gridConfig.areaLeft;
    const cols = Math.floor(gridWidth / (this.gridConfig.cardSize + this.gridConfig.spacing));
    const rows = Math.ceil(visibleGames.length / cols);

    // Position visible cards
    visibleGames.forEach((game, index) => {
      const card = this.gameCards.find(c => c.gameData.scene === game.scene);
      if (card) {
        const row = Math.floor(index / cols);
        const col = index % cols;

        const totalWidth = cols * this.gridConfig.cardSize + (cols - 1) * this.gridConfig.spacing;
        const startX = this.gridConfig.areaLeft + (gridWidth - totalWidth) / 2 + this.gridConfig.cardSize / 2;
        const startY = this.gridConfig.areaTop + this.gridConfig.cardSize / 2;

        const x = startX + col * (this.gridConfig.cardSize + this.gridConfig.spacing);
        const y = startY + row * (this.gridConfig.cardSize * 1.3 + this.gridConfig.spacing);

        card.setPosition(x, y);
        card.setVisible(true);

        // Pop effect animation (scale from 0 with Back.easeOut)
        card.setScale(0);
        card.setAlpha(1);
        this.tweens.add({
          targets: card,
          scale: 1,
          duration: 400,
          delay: index * 80,
          ease: 'Back.easeOut'
        });
      }
    });

    // Hide non-visible cards
    this.allGames.forEach(game => {
      if (!visibleGames.includes(game)) {
        const card = this.gameCards.find(c => c.gameData.scene === game.scene);
        if (card) {
          card.setVisible(false);
        }
      }
    });
  }

  /**
   * Clear existing bottom controls to prevent duplicates on scene restart
   */
  clearBottomControls() {
    if (this.bottomControls) {
      this.bottomControls.forEach(control => {
        if (control.button && control.button.destroy) control.button.destroy();
        if (control.shadow && control.shadow.destroy) control.shadow.destroy();
        if (control.icon && control.icon.destroy) control.icon.destroy();
        if (control.label && control.label.destroy) control.label.destroy();
      });
    }
    this.bottomControls = [];
  }

  /**
   * Create bottom control bar (3D Toy Style)
   */
  createBottomControls(width, height) {
    const barY = height - 55;
    const buttonSize = 72; // 20% larger (60 * 1.2)
    const spacing = 120; // Adjusted for larger buttons

    const controls = [
      { icon: 'exit', action: 'exit', color: 0xE32528 },
      { icon: 'settings', action: 'settings', color: 0x0062FF },
      { icon: 'help', action: 'help', color: 0x00B378 },
      { icon: 'home', action: 'home', color: 0xFACA2A }
    ];

    const totalWidth = (controls.length - 1) * spacing + buttonSize;
    const startX = (width - totalWidth) / 2 + buttonSize / 2;

    controls.forEach((control, index) => {
      const x = startX + index * spacing;

      // Fake 3D shadow (darker version of button color)
      const shadowColor = Phaser.Display.Color.GetColor(
        Phaser.Display.Color.IntegerToRGB(control.color).r * 0.6,
        Phaser.Display.Color.IntegerToRGB(control.color).g * 0.6,
        Phaser.Display.Color.IntegerToRGB(control.color).b * 0.6
      );
      const shadow = this.add.circle(x + 3, barY + 3, buttonSize / 2, shadowColor, 0.5);

      // Circular button background (3D effect)
      const button = this.add.circle(x, barY, buttonSize / 2, control.color);
      button.setStrokeStyle(4, 0xFFFFFF); // Thicker white border
      button.setInteractive({ useHandCursor: true });

      // Control icon
      const icon = this.add.sprite(x, barY, control.icon);
      icon.setScale((buttonSize * 0.7) / 100); // Slightly larger relative to button
      icon.setTint(0xFFFFFF);

      // Pressed effect (move down slightly)
      button.on('pointerdown', () => {
        button.setPosition(x, barY + 2);
        icon.setPosition(x, barY + 2);
        this.handleControlAction(control.action);

        // Reset position after short delay
        this.time.delayedCall(100, () => {
          button.setPosition(x, barY);
          icon.setPosition(x, barY);
        });
      });

      // Hover effects (more pronounced)
      button.on('pointerover', () => {
        button.setScale(1.15);
        button.setStrokeStyle(5, 0x000000);
        icon.setScale((buttonSize * 0.8) / 100);
      });

      button.on('pointerout', () => {
        button.setScale(1.0);
        button.setStrokeStyle(4, 0xFFFFFF);
        icon.setScale((buttonSize * 0.7) / 100);
      });

      this.bottomControls.push({
        button: button,
        shadow: shadow,
        icon: icon,
        action: control.action
      });
    });
  }

  /**
   * Handle bottom control actions
   */
  handleControlAction(action) {
    switch (action) {
      case 'exit':
        if (window.confirm('Are you sure you want to exit the game?')) {
          window.close();
        }
        break;
      case 'settings':
        // Open settings dialog
        console.log('Settings clicked');
        break;
      case 'help':
        // Show help modal
        this.showHelpModal();
        break;
      case 'home':
        // Reset to show all games
        this.selectCategory('all');
        break;
    }
  }

  /**
   * Show help modal
   */
  showHelpModal() {
    const { width, height } = this.game.config;

    // Overlay
    const overlay = this.add.rectangle(width / 2, height / 2, width, height, 0x000000, 0.7);
    overlay.setInteractive();
    overlay.on('pointerdown', () => this.closeHelpModal());

    // Modal background
    const modalBg = this.add.rectangle(width / 2, height / 2, 500, 400, 0xFDFAED);
    modalBg.setStrokeStyle(4, 0xFACA2A);

    // Help content
    const helpText = this.add.text(width / 2, height / 2, 'Welcome to Lalela Web Games!\n\n' +
      '• Choose a category by clicking the animal icons\n' +
      '• Click on game cards to start playing\n' +
      '• Difficulty stars show game complexity\n' +
      '• Use bottom controls for settings and help\n\n' +
      'Enjoy learning with fun!', {
      fontSize: '18px',
      color: '#101012',
      fontFamily: 'Nunito, sans-serif',
      align: 'center',
      wordWrap: { width: 450 }
    }).setOrigin(0.5);

    // Close button
    const closeBtn = this.add.circle(width / 2 + 220, height / 2 - 180, 20, 0xE32528);
    closeBtn.setInteractive({ useHandCursor: true });
    closeBtn.on('pointerdown', () => this.closeHelpModal());

    const closeText = this.add.text(width / 2 + 220, height / 2 - 180, '×', {
      fontSize: '24px',
      color: '#FFFFFF',
      fontFamily: 'Fredoka One, cursive'
    }).setOrigin(0.5);

    this.helpModal = [overlay, modalBg, helpText, closeBtn, closeText];
  }

  /**
   * Close help modal
   */
  closeHelpModal() {
    if (this.helpModal) {
      this.helpModal.forEach(element => element.destroy());
      this.helpModal = null;
    }
  }

  /**
   * Set up keyboard navigation for accessibility
   */
  setupKeyboardNavigation() {
    // Listen for keyboard events
    this.input.keyboard.on('keydown-TAB', (event) => {
      event.preventDefault();
      this.navigateNext();
    });

    this.input.keyboard.on('keydown-SHIFT_TAB', (event) => {
      event.preventDefault();
      this.navigatePrevious();
    });

    this.input.keyboard.on('keydown-ENTER', () => {
      this.activateCurrentCard();
    });

    this.input.keyboard.on('keydown-SPACE', (event) => {
      event.preventDefault();
      this.activateCurrentCard();
    });

    // Arrow key navigation
    this.input.keyboard.on('keydown-UP', () => this.navigateUp());
    this.input.keyboard.on('keydown-DOWN', () => this.navigateDown());
    this.input.keyboard.on('keydown-LEFT', () => this.navigateLeft());
    this.input.keyboard.on('keydown-RIGHT', () => this.navigateRight());

    // Category navigation (number keys)
    for (let i = 1; i <= this.categories.length; i++) {
      this.input.keyboard.on(`keydown-${i}`, () => {
        this.selectCategory(this.categories[i - 1].id);
      });
    }

    // Escape key for help
    this.input.keyboard.on('keydown-ESCAPE', () => {
      if (this.helpModal) {
        this.closeHelpModal();
      }
    });

    // H key for help
    this.input.keyboard.on('keydown-H', () => {
      this.showHelpModal();
    });
  }

  /**
   * Navigate to next card
   */
  navigateNext() {
    const visibleCards = this.gameCards.filter(card => card.visible);
